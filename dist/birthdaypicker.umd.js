/*!
* BirthdayPicker v0.1.23
* https://lemon3.github.io/birthdaypicker
*/
(function(d,c){typeof exports=="object"&&typeof module!="undefined"?module.exports=c():typeof define=="function"&&define.amd?define(c):(d=typeof globalThis!="undefined"?globalThis:d||self).BirthdayPicker=c()}(this,function(){"use strict";var $=Object.defineProperty;var I=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var w=(d,c,u)=>c in d?$(d,c,{enumerable:!0,configurable:!0,writable:!0,value:u}):d[c]=u,j=(d,c)=>{for(var u in c||(c={}))q.call(c,u)&&w(d,u,c[u]);if(I)for(var u of I(c))z.call(c,u)&&w(d,u,c[u]);return d};var k=(d,c,u)=>(w(d,typeof c!="symbol"?c+"":c,u),u);ifconst d={en:{year:"Year",month:"Month",day:"Day"},de:{year:"Jahr",month:"Monat",day:"Tag"},fr:{year:"AnnÃ©e",month:"Mois",day:"Jour"}},c=(n,e,t,r)=>((i,s,a,h)=>{if(s)for(const l in s)i.setAttribute(l,s[l]);if(a)for(const l in a)i.style[l]=a[l];return h&&(i.innerHTML=h),i})(document.createElement(n),e,t,r),u=n=>+n%4==0&&+n%100!=0||+n%400==0,v={_s:new WeakMap,put(n,...e){this._s.has(n)||this._s.set(n,new Map);let t=this._s.get(n);if(e.length>1)return t.set(e[0],e[1]),this;if(typeof e[0]=="object")for(const r in e[0])t.set(r,e[0][r]);else t.set(e[0]);return this},get(n,e){return!!this._s.has(n)&&(e?this._s.get(n).get(e):this._s.get(n))},has(n,e){return this._s.has(n)&&this._s.get(n).has(e)},remove(n,e){if(!this._s.has(n))return!1;let t=this._s.get(n).delete(e);return this._s.get(n).size===0&&this._s.delete(n),t}},M=(n,e,t)=>{if(n=parseFloat(n,10),isNaN(n))return NaN;if(e=parseFloat(e,10),(t=parseFloat(t,10))<e){let r=t;t=e,e=r}return!isNaN(e)&&n<e?e:!isNaN(t)&&n>t?t:n};let _=[];const Y="birthdaypicker",F="data-"+Y,O=["short","long","numeric"],W=["ymd","ydm","myd","mdy","dmy","dym"],x="init",N="datechange",T="daychange",C="monthchange",S="yearchange",A="kill",Z=[x,N,T,C,S,A],b="option",p={y:"year",m:"month",d:"day"},D=new Date,f={y:D.getFullYear(),m:D.getMonth()+1,d:D.getDate(),t:D.getTime()};let E=!1;const L=n=>n===!0||n==="true"||n===1||n==="1";class o{constructor(e,t){k(this,"_onSelect",e=>{e.target===this._year.el?this._yearWasChanged(+e.target.value):e.target===this._month.el?this._monthWasChanged(+e.target.value):e.target===this._day.el&&this._dayWasChanged(+e.target.value),this._dateChanged()});if(!e)return{error:!0};if((e=typeof e=="string"?document.querySelector(e):e)===null||e.length===0)return{error:!0};if(e.dataset.bdpInit)return o.getInstance(e);e.dataset.bdpInit=!0,_.push(this),v.put(e,"instance",this);const r=((i,s,a=null)=>{if(!i)return!1;if(s===void 0||i.dataset[s]===void 0)return i.dataset;let h;try{h=JSON.parse(i.dataset[s].replace(/'/g,'"'))}catch(g){}if(typeof h!="object"){h=i.dataset[s];const g={};h=h.replace(/ /g,"");const y=h.split(",");y.length>1?y.forEach(B=>{const[H,P]=B.split(":");g[H.replace(/'/g,"")]=P.replace(/'/g,"")}):g[s]=h,h=g}let l={},m=s.length;return Object.entries(i.dataset).forEach(g=>{if(g[0].toLowerCase().indexOf(s)>=0&&g[0].length>m){let y=g[0][m].toLowerCase()+g[0].substring(m+1);(a===null||a&&a[y]!==void 0)&&(l[y]=g[1])}}),Object.assign(h,l)})(e,Y,o.defaults);this.options=t||{},this.settings=Object.assign({},o.defaults,r,t),this.element=e,this.settings.autoInit&&this.init()}_parseDate(e){typeof e!="object"&&(e=e.replaceAll("-","/"));const t=Date.parse(e);return isNaN(t)?!1:{year:(e=new Date(t)).getFullYear(),month:e.getMonth()+1,day:e.getDate()}}_getIdx(e,t){if(e&&!isNaN(t||t===void 0)){for(let r,i=0;i<e.length;i++)if(r=e[i],+r.value==+t)return i}}_updateSelectBox(e,t){const r=this[e].el;r.selectedIndex=this._getIdx(r.childNodes,t)}_setYear(e){return e=M(e,this._yearFrom,this._yearTo),this.currentYear!==e&&(this._updateSelectBox("_year",e),this._yearWasChanged(e,!1),!0)}_setMonth(e){return e=M(e,1,12),this.currentMonth!==e&&(this._updateSelectBox("_month",e),this._monthWasChanged(e,!1),!0)}_setDay(e){return e=M(e,1,this._getDaysPerMonth()),this.currentDay!==e&&(this._updateSelectBox("_day",e),this._dayWasChanged(e,!1),!0)}_getDateInRange({year:e=this.currentYear,month:t=this.currentMonth,day:r=this.currentDay}){const i=this._lowerLimit,s=this._upperLimit;return e>s.year||e>=s.year&&t>s.month||e>=s.year&&t>=s.month&&r>s.day?s:e<i.year||e<=i.year&&t<i.month||e<=i.year&&t<=i.month&&r<i.day?i:{year:e,month:t,day:r}}_setDate(e,t=!1){e=this._getDateInRange(e);let r=this._setYear(e.year),i=this._setMonth(e.month),s=this._setDay(e.day);return(r||i||s)&&this._dateChanged(t),e}_getMonthText(e){return this.settings.monthFormat!=="numeric"?e:this.settings.leadingZero&&+e<10?"0"+e:""+e}_checkArrangement(e){return e=e.toLowerCase(),W.indexOf(e)<0?"ymd":e}_mapSelectBoxes(){let e=this.element.querySelectorAll("select");const t={};if(e.length===0)return t;let r=this.settings.arrange.split("");return r.forEach(i=>{const s=p[i];let a=this.settings[s+"El"]||"["+F+"-"+s+"]";if(a){let h;if(h=a.nodeName!==void 0?a:this.element.querySelector(a),h)return t[s]=h,r=r.filter(l=>l!==i),void(e=Object.values(e).filter(l=>l!==h))}e=Object.values(e).filter(h=>{const l=h.attributes[F+"-"+s];return l&&(t[s]=h,r=r.filter(m=>m!==i)),!l})}),r.forEach((i,s)=>{t[p[i]]=e[s]}),t}_create(){const e=this.settings;e.arrange=this._checkArrangement(e.arrange);const t=this._mapSelectBoxes();e.arrange.split("").forEach(s=>{const a=p[s];let h=!1,l=t[a];l&&!l.dataset.init||(l=c("select"),h=!0,this.element.append(l)),l.setAttribute("aria-label",`select ${a}`),e.className&&(l.classList.add(e.className),l.classList.add(`${e.className}-${a}`)),l.dataset.init=!0;const m="change",g=this._onSelect,y=!1;l.addEventListener(m,g,y),this._registeredEventListeners.push({element:l,eventName:m,listener:g,option:y}),this["_"+a]={el:l,name:a,created:h,df:document.createDocumentFragment()},this._date.push(this["_"+a])});const r=c(b);e.placeholder&&this._date.forEach(s=>{const a=o.i18n[e.locale][s.name],h=r.cloneNode();h.innerHTML=a,s.df.appendChild(h)});for(let s=this._yearTo;s>=this._yearFrom;s--){const a=r.cloneNode();a.value=s,a.innerHTML=s,this._year.df.append(a)}let i;this.monthFormat[e.monthFormat].forEach((s,a)=>{const h=r.cloneNode();h.value=a+1,h.innerHTML=this._getMonthText(s),this._month.df.append(h)});for(let s=1;s<=31;s++){i=e.leadingZero&&s<10?"0"+s:s;const a=c(b,{value:s},"",i);this._day.df.append(a)}this._date.forEach(s=>s.el.append(s.df))}_updateDays(e=this.currentMonth){let t=this._getDaysPerMonth(e);const r=this.settings.placeholder?1:0,i=this._day.el.children.length-r;if(t!==i)if(t===void 0&&(t=31),t-i>0)for(let s=i;s<t;s++){let a=c(b,{value:s+1},"",""+(s+1));this._day.el.append(a)}else{for(let s=i;s>t;s--)this._day.el.children[s+r-1].remove();this.currentDay>t&&(this.settings.roundDownDay?this._setDay(t):this._dayWasChanged(void 0))}}_triggerEvent(e,t){const r=j({instance:this,year:+this._year.el.value,month:+this._month.el.value,day:+this._day.el.value,date:this.getDate()},t),i=new CustomEvent(e,{detail:r});this.element.dispatchEvent(i),this.eventFired[e]=i,this.settings[e]&&typeof this.settings[e]=="function"&&this.settings[e].call(this,i),((s,a,h)=>{let l=s.getAttribute("on"+a);new Function("e","{"+l+"}").call(s,h)})(this.element,e,i)}_disable(e,t,r){const i=t==="<"?s=>s<r:s=>s>r;this[e].el.childNodes.forEach(s=>{i(+s.value)&&(s.disabled=!0,this._disabled.push(s))})}_noFutureDate(e=this._lowerLimit,t=this._upperLimit){const r=()=>{this.currentYear>t.year&&this._setYear(t.year),this._disable("_month",">",t.month);const s=this.currentMonth>t.month;s&&this._setMonth(t.month),t.month===this.currentMonth&&(this._disable("_day",">",t.day),(s||this.currentDay>t.day)&&this._setDay(t.day))},i=()=>{this.currentYear<e.year&&this._setYear(e.year),this._disable("_month","<",e.month);const s=this.currentMonth<e.month;s&&this._setMonth(e.month),e.month===this.currentMonth&&(this._disable("_day","<",e.day),(s||this.currentDay<e.day)&&this._setDay(e.day))};return this._disabled.length&&(this._disabled.forEach(s=>{s.disabled=!1}),this._disabled=[]),!(this.currentYear<t.year&&this.currentYear>e.year||!this.currentYear||!(this.currentYear||this.currentMonth||this.currentDay))&&(this.currentYear>=t.year?r():this.currentYear<=e.year&&i(),!0)}_yearWasChanged(e,t=!0){this.currentYear=e,this._daysPerMonth[1]=u(e)?29:28,t&&this._triggerEvent(S),this.currentMonth===2&&this._updateDays()}_monthWasChanged(e,t=!0){this.currentMonth=e,t&&this._triggerEvent(C),this._updateDays()}_dayWasChanged(e,t=!0){this.currentDay=e,t&&this._triggerEvent(T)}_dateChanged(e=!0){this.settings.selectFuture||this._noFutureDate(this._lowerLimit,this._upperLimit),e&&this._triggerEvent(N),this.element.value=this.getDateString()}_updateDayList(){const e=this.settings.placeholder?1:0,t=this.settings.leadingZero?"0":"";for(let r=e;r<9+e;r++)this._day.el.childNodes[r].innerHTML=t+r}_updateMonthList(){const e=this.settings.monthFormat,t=this.settings.placeholder?1:0;this.monthFormat[e].forEach((r,i)=>{this._month.el.childNodes[i+t].innerHTML=this._getMonthText(r)})}useLeadingZero(e){(e=L(e))!==this.settings.leadingZero&&(this.settings.leadingZero=e,this.settings.monthFormat==="numeric"&&this._updateMonthList(),this._updateDayList())}_getDaysPerMonth(e=this.currentMonth){return this._daysPerMonth[+e-1]}setMonthFormat(e){return!(!this.monthFormat[e]||e===this.settings.monthFormat)&&(this.settings.monthFormat=e,this._updateMonthList(),!0)}setLanguage(e){if(e===this.settings.locale||(""+e).length<2||(""+e).length>2)return!1;o.createLocale(e);const t=o.i18n[e];if(this.settings.placeholder&&this._date.forEach(i=>{i.el.childNodes[0].innerHTML=t[i.name]}),this.monthFormat=t.monthFormat,this.settings.locale=e,this.settings.monthFormat==="numeric")return!1;let r=this.settings.placeholder?1:0;this.monthFormat[this.settings.monthFormat].forEach((i,s)=>{this._month.el.childNodes[r+s].innerHTML=i})}setDate(e,t=!1){let r=this._parseDate(e);return r&&(r=this._setDate(r,t)),r}resetDate(e=!1){let t="";this.startDate&&e?(this._setDate(this.startDate),t=this.getDateString()):this._setDate({year:NaN,month:NaN,day:NaN}),this.element.value=t,this._triggerEvent(N)}addEventListener(e,t,r){if(Z.indexOf(e)<0||typeof t!="function")return!1;this.element.addEventListener(e,t,r),this._registeredEventListeners.push({element:this.element,eventName:e,listener:t,option:r}),this.eventFired[e]&&t.call(this.element,this.eventFired[e])}removeEventListener(e,t,r){this.element.removeEventListener(e,t,r)}kill(){this.eventFired={},this._registeredEventListeners&&this._registeredEventListeners.forEach(e=>e.element.removeEventListener(e.eventName,e.listener,e.option)),this._date.forEach(e=>{if(e.created)e.el.remove();else{const t=this.settings.className;t&&(e.el.classList.remove(t),Object.values(p).forEach(r=>{e.el.classList.remove(`${t}-${r}`)}))}}),this._triggerEvent(A)}isLeapYear(e=this.currentYear){return e===void 0?void 0:u(e)}getAge(){if(isNaN(this.currentYear)||isNaN(this.currentMonth)||isNaN(this.currentDay))return"";const e=this.currentYear,t=this.currentMonth,r=this.currentDay,i=new Date,s=i.getMonth()+1;let a=i.getFullYear()-e;return s<t||s===t&&i.getDate()<r?--a:a}getDateString(e){if(!e){const r=this.getDate();return r&&r.toLocaleDateString(this.settings.locale)}if(!this.currentYear||!this.currentMonth||!this.currentDay)return"";let t=e.toLowerCase();return t=t.replace(/yyyy/g,this.currentYear),t=t.replace(/yy/g,(""+this.currentYear).slice(2)),t=t.replace(/mm/g,("0"+this.currentMonth).slice(-2)),t=t.replace(/m/g,this.currentMonth),t=t.replace(/dd/g,("0"+this.currentDay).slice(-2)),t=t.replace(/d/g,this.currentDay),t}getDate(){return this.currentYear&&this.currentMonth&&this.currentDay?new Date(Date.UTC(this.currentYear,+this.currentMonth-1,this.currentDay)):""}_getUpperLimit(e){if(e.upperLimit)return e.upperLimit;let t;return e.maxYear==="now"?(t=f.y-+e.minAge,{year:t,month:f.m,day:f.d}):(t=e.maxYear,{year:t,month:12,day:31})}_getLowerLimit(e){if(e.lowerLimit)return e.lowerLimit;let t;return e.minYear!==null?(t=+e.minYear,{year:t,month:1,day:1}):(t=(e.maxYear==="now"?f.y:e.maxYear)-+e.maxAge,{year:t,month:f.m,day:f.d})}init(){if(this.initialized)return!0;this.initialized=!0,this.eventFired={},this._registeredEventListeners=[],this._daysPerMonth=[31,28,31,30,31,30,31,31,30,31,30,31],this._date=[],this._disabled=[];const e=this.settings;e.placeholder=L(e.placeholder),e.leadingZero=L(e.leadingZero),e.selectFuture=L(e.selectFuture),this._lowerLimit=this._getLowerLimit(e),this._upperLimit=this._getUpperLimit(e),this._yearFrom=this._lowerLimit.year,this._yearTo=this._upperLimit.year;const[t]=o.createLocale(e.locale);if(e.locale=t,this.monthFormat=o.i18n[e.locale].monthFormat,this._create(),this._triggerEvent(x),e.defaultDate){const r=this.setDate(e.defaultDate==="now"?new Date().toString():e.defaultDate,!0);this.startDate=r}}}return o.i18n={},o.currentLocale="en",o.getInstance=n=>v.get(n,"instance"),o.createLocale=n=>{if(n&&n.length===2||(n="en"),o.i18n[n])return[n,o.i18n[n]];let e=new Date("2000-01-15"),t={monthFormat:{}};for(let s=0;s<12;s++)e.setMonth(s),O.forEach(a=>{t.monthFormat[a]=t.monthFormat[a]||[],t.monthFormat[a].push(e.toLocaleDateString(n,{month:a}))});const r="BirthdayPickerLocale";let i=d[n]?d[n]:d.en;return window[r]&&window[r][n]&&(i=Object.assign({},i,window[r][n])),o.i18n[n]=Object.assign(t,i),[n,t]},o.setMonthFormat=n=>{_.forEach(e=>{e.setMonthFormat(n)})},o.setLanguage=n=>{o.currentLocale=n,_.forEach(e=>{e.setLanguage(n)})},o.killAll=()=>!!_.length&&(_.forEach(n=>{o.kill(n)}),_=[],!0),o.kill=n=>{if(!n||(n.element||(n=o.getInstance(n)),!n))return!1;n.kill();const e=n.element;return e.dataset.bdpInit=!1,delete e.dataset.bdpInit,v.remove(e,"instance"),E=!1,!0},o.defaults={minAge:0,maxAge:100,minYear:null,maxYear:"now",lowerLimit:null,upperLimit:null,monthFormat:"short",placeholder:!0,className:null,defaultDate:null,autoInit:!0,leadingZero:!0,locale:"en",selectFuture:!1,arrange:"ymd",yearEl:null,monthEl:null,dayEl:null,roundDownDay:!0},o.init=()=>{if(E)return!1;E=!0,o.createLocale(o.currentLocale);let n=document.querySelectorAll("["+F+"]");return n.length!==0&&(n.forEach(e=>{new o(e)}),_)},o}),globalThis.getDomData)for(const d of Object.keys(globalThis.getDomData))globalThis[d]=globalThis.getDomData[d];
