/*!
* BirthdayPicker v0.1.20
* https://lemon3.github.io/birthdaypicker
*/
(function(l,o){typeof exports=="object"&&typeof module!="undefined"?module.exports=o():typeof define=="function"&&define.amd?define(o):(l=typeof globalThis!="undefined"?globalThis:l||self).BirthdayPicker=o()}(this,function(){"use strict";var O=Object.defineProperty;var w=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable;var b=(l,o,u)=>o in l?O(l,o,{enumerable:!0,configurable:!0,writable:!0,value:u}):l[o]=u,C=(l,o)=>{for(var u in o||(o={}))W.call(o,u)&&b(l,u,o[u]);if(w)for(var u of w(o))Z.call(o,u)&&b(l,u,o[u]);return l};var x=(l,o,u)=>(b(l,typeof o!="symbol"?o+"":o,u),u);ifconst l={en:{year:"Year",month:"Month",day:"Day"},de:{year:"Jahr",month:"Monat",day:"Tag"},fr:{year:"AnnÃ©e",month:"Mois",day:"Jour"}},o=(n,e,t,a)=>((s,r,i,d)=>{if(r)for(const c in r)s.setAttribute(c,r[c]);if(i)for(const c in i)s.style[c]=i[c];return d&&(s.innerHTML=d),s})(document.createElement(n),e,t,a),u=n=>+n%4==0&&+n%100!=0||+n%400==0,M={_s:new WeakMap,put(n,...e){this._s.has(n)||this._s.set(n,new Map);let t=this._s.get(n);if(e.length>1)return t.set(e[0],e[1]),this;if(typeof e[0]=="object")for(const a in e[0])t.set(a,e[0][a]);else t.set(e[0]);return this},get(n,e){return!!this._s.has(n)&&(e?this._s.get(n).get(e):this._s.get(n))},has(n,e){return this._s.has(n)&&this._s.get(n).has(e)},remove(n,e){if(!this._s.has(n))return!1;let t=this._s.get(n).delete(e);return this._s.get(n).size===0&&this._s.delete(n),t}},L=(n,e,t)=>{if(n=parseFloat(n,10),isNaN(n))return NaN;if(e=parseFloat(e,10),(t=parseFloat(t,10))<e){let a=t;t=e,e=a}return!isNaN(e)&&n<e?e:!isNaN(t)&&n>t?t:n};let y=[];const N="birthdaypicker",T="data-"+N,S=["short","long","numeric"],A=["ymd","ydm","myd","mdy","dmy","dym"],m=["init","datechange","daychange","monthchange","yearchange","kill"],F="option",Y={y:"year",m:"month",d:"day"},p=new Date,D={y:p.getFullYear(),m:p.getMonth()+1,d:p.getDate(),t:p.getTime()};let E=!1;const v=n=>n===!0||n==="true"||n===1||n==="1";class h{constructor(e,t){x(this,"_onSelect",e=>{e.target===this._year.el?this._yearWasChanged(+e.target.value):e.target===this._month.el?this._monthWasChanged(+e.target.value):e.target===this._day.el&&this._dayWasChanged(+e.target.value),this._dateChanged()});if(!e)return{error:!0};if((e=typeof e=="string"?document.querySelector(e):e)===null||e.length===0)return{error:!0};if(e.dataset.bdpInit)return h.getInstance(e);e.dataset.bdpInit=!0,y.push(this),M.put(e,"instance",this);const a=((s,r,i=null)=>{if(!s)return!1;if(r===void 0||s.dataset[r]===void 0)return s.dataset;let d;try{d=JSON.parse(s.dataset[r].replace(/'/g,'"'))}catch(g){}if(typeof d!="object"){d=s.dataset[r];const g={};d=d.replace(/ /g,"");const _=d.split(",");_.length>1?_.forEach(k=>{const[I,j]=k.split(":");g[I.replace(/'/g,"")]=j.replace(/'/g,"")}):g[r]=d,d=g}let c={},f=r.length;return Object.entries(s.dataset).forEach(g=>{if(g[0].toLowerCase().indexOf(r)>=0&&g[0].length>f){let _=g[0][f].toLowerCase()+g[0].substring(f+1);(i===null||i&&i[_]!==void 0)&&(c[_]=g[1])}}),Object.assign(d,c)})(e,N,h.defaults);this.options=t,this.settings=Object.assign({},h.defaults,a,t),this.element=e,this.settings.autoInit&&this.init()}_parseDate(e){typeof e!="object"&&(e=e.replaceAll("-","/"));const t=Date.parse(e);return isNaN(t)?!1:{year:(e=new Date(t)).getFullYear(),month:e.getMonth()+1,day:e.getDate()}}_getIdx(e,t){if(e&&!isNaN(t||t===void 0)){for(let a,s=0;s<e.length;s++)if(a=e[s],+a.value==+t)return s}}_updateSelectBox(e,t){const a=this[e].el;a.selectedIndex=this._getIdx(a.childNodes,t)}_dateChanged(){this.settings.selectFuture||this._noFutureDate(D.y,D.m,D.d),this._triggerEvent(m[1]),this.element.value=this.getDateString()}_setYear(e,t=!0){return e=L(e,this._yearFrom,this._yearTo),this.currentYear!==e&&(this._updateSelectBox("_year",e),this._yearWasChanged(e),t&&this._dateChanged(),!0)}_setMonth(e,t=!0){return e=L(e,1,12),this.currentMonth!==e&&(this._updateSelectBox("_month",e),this._monthWasChanged(e),t&&this._dateChanged(),!0)}_setDay(e,t=!0){return e=L(e,1,this._getDaysPerMonth()),this.currentDay!==e&&(this._updateSelectBox("_day",e),this._dayWasChanged(e),t&&this._dateChanged(),!0)}_setDate({year:e,month:t,day:a}){this._monthChangeTriggeredLater=t!==this.currentMonth;let s=this._setYear(e,!1),r=this._setMonth(t,!1),i=this._setDay(a,!1);(s||r||i)&&this._dateChanged(),this._monthChangeTriggeredLater=!1}_getMonthText(e){return this.settings.monthFormat!=="numeric"?e:this.settings.leadingZero&&+e<10?"0"+e:""+e}_checkArrangement(e){return A.indexOf(e)<0?"ymd":e}_create(){const e=this.settings;e.arrange=this._checkArrangement(e.arrange),e.arrange.split("").forEach(s=>{const r=Y[s];let i,d=!1,c=e[r+"El"];c&&c.nodeName!==void 0?i=c:(c=c||"["+T+"-"+r+"]",i=this.element.querySelector(c)),i&&!i.dataset.init||(i=o("select"),d=!0,this.element.append(i)),i.setAttribute("aria-label",`select ${r}`),e.className&&(i.classList.add(e.className),i.classList.add(`${e.className}-${r}`)),i.dataset.init=!0;const f="change",g=this._onSelect,_=!1;i.addEventListener(f,g,_),this._registeredEventListeners.push({element:i,eventName:f,listener:g,option:_}),this["_"+r]={el:i,name:r,created:d,df:document.createDocumentFragment()},this._date.push(this["_"+r])});const t=o(F);e.placeholder&&this._date.forEach(s=>{const r=h.i18n[e.locale][s.name],i=t.cloneNode();i.innerHTML=r,s.df.appendChild(i)});for(let s=this._yearTo;s>=this._yearFrom;s--){const r=t.cloneNode();r.value=s,r.innerHTML=s,this._year.df.append(r)}let a;this.monthFormat[e.monthFormat].forEach((s,r)=>{const i=t.cloneNode();i.value=r+1,i.innerHTML=this._getMonthText(s),this._month.df.append(i)});for(let s=1;s<=31;s++){a=e.leadingZero&&s<10?"0"+s:s;const r=o(F,{value:s},"",a);this._day.df.append(r)}this._date.forEach(s=>s.el.append(s.df))}_updateDays(e=this.currentMonth){let t=this._getDaysPerMonth(e);const a=this.settings.placeholder?1:0,s=this._day.el.children.length-a;if(t!==s)if(t===void 0&&(t=31),t-s>0)for(let r=s;r<t;r++){let i=o(F,{value:r+1},"",""+(r+1));this._day.el.append(i)}else{for(let r=s;r>t;r--)this._day.el.children[r+a-1].remove();this.currentDay>t&&(this.settings.roundDownDay?this._setDay(t,!1):this._dayWasChanged(void 0))}}_triggerEvent(e,t){const a=C({instance:this,year:+this._year.el.value,month:+this._month.el.value,day:+this._day.el.value,date:this.getDate()},t),s=new CustomEvent(e,{detail:a});this.element.dispatchEvent(s),this.eventFired[e]=s,((r,i,d)=>{let c=r.getAttribute("on"+i);new Function("e","{"+c+"}").call(r,d)})(this.element,e,s)}_noFutureDate(e,t,a){if(this._disabled.length&&(this._disabled.forEach(r=>{r.disabled=!1}),this._disabled=[]),this.currentYear<e||!this.currentYear||!this.currentYear&&!this.currentMonth&&!this.currentDay)return!1;this.currentYear>e&&this._setYear(e,!1),this._month.el.childNodes.forEach(r=>{r.value>t&&(r.disabled=!0,this._disabled.push(r))});const s=this.currentMonth>t;return s&&this._setMonth(t,!1),t===this.currentMonth&&(this._day.el.childNodes.forEach(r=>{r.value>a&&(r.disabled=!0,this._disabled.push(r))}),(s||this.currentDay>a)&&this._setDay(a,!1)),!0}_dayWasChanged(e){this.currentDay=e,this._triggerEvent(m[2])}_monthWasChanged(e){this.currentMonth=e,this._triggerEvent(m[3]),this._updateDays()}_yearWasChanged(e){this.currentYear=e,this._daysPerMonth[1]=u(e)?29:28,this._triggerEvent(m[4]),this._monthChangeTriggeredLater||this.currentMonth!==2||this._updateDays()}_updateDayList(){const e=this.settings.placeholder?1:0,t=this.settings.leadingZero?"0":"";for(let a=e;a<9+e;a++)this._day.el.childNodes[a].innerHTML=t+a}_updateMonthList(){const e=this.settings.monthFormat,t=this.settings.placeholder?1:0;this.monthFormat[e].forEach((a,s)=>{this._month.el.childNodes[s+t].innerHTML=this._getMonthText(a)})}useLeadingZero(e){(e=v(e))!==this.settings.leadingZero&&(this.settings.leadingZero=e,this.settings.monthFormat==="numeric"&&this._updateMonthList(),this._updateDayList())}_getDaysPerMonth(e=this.currentMonth){return this._daysPerMonth[+e-1]}setMonthFormat(e){return!(!this.monthFormat[e]||e===this.settings.monthFormat)&&(this.settings.monthFormat=e,this._updateMonthList(),!0)}setLanguage(e){if(e===this.settings.locale||(""+e).length<2||(""+e).length>2)return!1;h.createLocale(e);const t=h.i18n[e];if(this.settings.placeholder&&this._date.forEach(s=>{s.el.childNodes[0].innerHTML=t[s.name]}),this.monthFormat=t.monthFormat,this.settings.locale=e,this.settings.monthFormat==="numeric")return!1;let a=this.settings.placeholder?1:0;this.monthFormat[this.settings.monthFormat].forEach((s,r)=>{this._month.el.childNodes[a+r].innerHTML=s}),this._triggerEvent(m[1])}setDate(e){let t=this._parseDate(e);return t&&this._setDate(t),t}resetDate(e=!1){let t=this.startDate&&e?this.startDate:{year:void 0,month:void 0,day:void 0};this._setDate(t)}addEventListener(e,t,a){if(m.indexOf(e)<0||typeof t!="function")return!1;this.element.addEventListener(e,t,a),this._registeredEventListeners.push({element:this.element,eventName:e,listener:t,option:a}),this.eventFired[e]&&t.call(this.element,this.eventFired[e])}removeEventListener(e,t,a){this.element.removeEventListener(e,t,a)}kill(){this.eventFired={},this._registeredEventListeners&&this._registeredEventListeners.forEach(e=>e.element.removeEventListener(e.eventName,e.listener,e.option)),this._date.forEach(e=>{if(e.created)e.el.remove();else{const t=this.settings.className;t&&(e.el.classList.remove(t),Object.values(Y).forEach(a=>{e.el.classList.remove(`${t}-${a}`)}))}}),this._triggerEvent(m[5])}isLeapYear(e=this.currentYear){return e===void 0?void 0:u(e)}getAge(){const e=this.currentYear,t=this.currentMonth,a=this.currentDay,s=new Date,r=s.getMonth()+1;let i=s.getFullYear()-e;return r<t||r===t&&s.getDate()<a?--i:i}getDateString(e){if(!e){const a=this.getDate();return a&&a.toLocaleDateString(this.settings.locale)}if(!this.currentYear||!this.currentMonth||!this.currentDay)return"";let t=e.toLowerCase();return t=t.replace(/yyyy/g,this.currentYear),t=t.replace(/yy/g,(""+this.currentYear).slice(2)),t=t.replace(/mm/g,("0"+this.currentMonth).slice(-2)),t=t.replace(/m/g,this.currentMonth),t=t.replace(/dd/g,("0"+this.currentDay).slice(-2)),t=t.replace(/d/g,this.currentDay),t}getDate(){return this.currentYear&&this.currentMonth&&this.currentDay?new Date(Date.UTC(this.currentYear,+this.currentMonth-1,this.currentDay)):""}init(){if(this.initialized)return!0;this.initialized=!0,this.eventFired={},this._registeredEventListeners=[],this._daysPerMonth=[31,28,31,30,31,30,31,31,30,31,30,31],this._date=[],this._disabled=[];const e=this.settings;if(e.placeholder=v(e.placeholder),e.leadingZero=v(e.leadingZero),e.selectFuture=v(e.selectFuture),e.maxYear==="now"?this._yearTo=D.y:this._yearTo=e.maxYear,e.minYear?this._yearFrom=+e.minYear:this._yearFrom=this._yearTo-+e.maxAge,this._yearTo-=+e.minAge,h.createLocale(e.locale),this.monthFormat=h.i18n[e.locale].monthFormat,this._create(),this._triggerEvent(m[0]),e.defaultDate){const t=this.setDate(e.defaultDate==="now"?new Date().toString():e.defaultDate);this.currentYear=t.year,this.currentMonth=t.month,this.currentDay=t.day,this.startDate=t}}}return h.i18n={},h.currentLocale="en",h.getInstance=n=>M.get(n,"instance"),h.createLocale=n=>{if(n&&n.length===2||(n="en"),h.i18n[n])return h.i18n[n];let e=new Date("2000-01-15"),t={monthFormat:{}};for(let r=0;r<12;r++)e.setMonth(r),S.forEach(i=>{t.monthFormat[i]=t.monthFormat[i]||[],t.monthFormat[i].push(e.toLocaleDateString(n,{month:i}))});const a="BirthdayPickerLocale";let s=l[n]?l[n]:l.en;return window[a]&&window[a][n]&&(s=Object.assign({},s,window[a][n])),h.i18n[n]=Object.assign(t,s),t},h.setMonthFormat=n=>{y.forEach(e=>{e.setMonthFormat(n)})},h.setLanguage=n=>{h.currentLocale=n,y.forEach(e=>{e.setLanguage(n)})},h.killAll=()=>!!y.length&&(y.forEach(n=>{h.kill(n)}),y=[],!0),h.kill=n=>{if(!n||(n.element||(n=h.getInstance(n)),!n))return!1;n.kill();const e=n.element;return e.dataset.bdpInit=!1,delete e.dataset.bdpInit,M.remove(e,"instance"),E=!1,!0},h.defaults={minYear:null,maxYear:"now",minAge:0,maxAge:100,monthFormat:"short",placeholder:!0,className:null,defaultDate:null,autoInit:!0,leadingZero:!0,locale:"en",selectFuture:!1,arrange:"ymd",yearEl:null,monthEl:null,dayEl:null,roundDownDay:!0},h.init=()=>{if(E)return!1;E=!0,h.createLocale(h.currentLocale);let n=document.querySelectorAll("["+T+"]");return n.length!==0&&(n.forEach(e=>{new h(e)}),y)},h}),globalThis.getDomData)for(const l of Object.keys(globalThis.getDomData))globalThis[l]=globalThis.getDomData[l];
