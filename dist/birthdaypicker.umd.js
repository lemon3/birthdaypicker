/*!
* BirthdayPicker v0.2.1
* https://lemon3.github.io/birthdaypicker
*/
(function(d,l){typeof exports=="object"&&typeof module!="undefined"?module.exports=l():typeof define=="function"&&define.amd?define(l):(d=typeof globalThis!="undefined"?globalThis:d||self,d.BirthdayPicker=l())})(this,function(){"use strict";var G=Object.defineProperty;var H=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable;var Y=(d,l,f)=>l in d?G(d,l,{enumerable:!0,configurable:!0,writable:!0,value:f}):d[l]=f,W=(d,l)=>{for(var f in l||(l={}))J.call(l,f)&&Y(d,f,l[f]);if(H)for(var f of H(l))P.call(l,f)&&Y(d,f,l[f]);return d};var j=(d,l,f)=>(Y(d,typeof l!="symbol"?l+"":l,f),f);const d={minAge:0,maxAge:100,minYear:null,maxYear:"now",lowerLimit:null,upperLimit:null,monthFormat:"short",placeholder:!0,className:null,defaultDate:null,autoInit:!0,leadingZero:!0,locale:"en",selectFuture:!1,arrange:"ymd",yearEl:null,monthEl:null,dayEl:null,roundDownDay:!0},l={en:{year:"Year",month:"Month",day:"Day"},de:{year:"Jahr",month:"Monat",day:"Tag"},fr:{year:"AnnÃ©e",month:"Mois",day:"Jour"}},f=(r,i,t,e)=>{if(i)for(const n in i)r.setAttribute(n,i[n]);if(t)for(const n in t)r.style[n]=t[n];return e&&(r.innerHTML=e),r},y=(r,i,t,e)=>f(document.createElement(r),i,t,e),B=(r,i,t=null)=>{if(!r)return!1;if(i===void 0||r.dataset[i]===void 0)return r.dataset;let e;try{r.dataset[i]!=="undefined"&&r.dataset[i].indexOf("{")>=0&&(e=JSON.parse(r.dataset[i].replace(/'/g,'"')))}catch(s){console.error(s)}if(typeof e!="object"){e=r.dataset[i];const s={};e=e.replace(/ /g,"");const h=e.split(",");h.length>1?h.forEach(c=>{const[u,m]=c.split(":");s[u.replace(/'/g,"")]=m.replace(/'/g,"")}):s[i]=e,e=s}let n={},a=i.length;return Object.entries(r.dataset).forEach(s=>{if(s[0].toLowerCase().indexOf(i)>=0&&s[0].length>a){let h=s[0][a].toLowerCase()+s[0].substring(a+1);(t===null||t&&t[h]!==void 0)&&(n[h]=s[1])}}),Object.assign(e,n)},v=r=>+r%4===0&&+r%100!==0||+r%400===0,L={_s:new WeakMap,put(r,...i){this._s.has(r)||this._s.set(r,new Map);let t=this._s.get(r);if(i.length>1)return t.set(i[0],i[1]),this;if(typeof i[0]=="object")for(const e in i[0])t.set(e,i[0][e]);else t.set(i[0]);return this},get(r,i){return this._s.has(r)?i?this._s.get(r).get(i):this._s.get(r):!1},has(r,i){return this._s.has(r)&&this._s.get(r).has(i)},remove(r,i){if(!this._s.has(r))return!1;let t=this._s.get(r).delete(i);return this._s.get(r).size===0&&this._s.delete(r),t}},M=(r,i,t)=>{if(r=parseFloat(r,10),isNaN(r))return NaN;if(i=parseFloat(i,10),t=parseFloat(t,10),t<i){let e=t;t=i,i=e}return!isNaN(i)&&r<i?i:!isNaN(t)&&r>t?t:r},Z=(r,i,t)=>{let e=r.getAttribute("on"+i);new Function("e","{"+e+"}").call(r,t)};class q{constructor(){this._eventCallbacks=this._eventCallbacks||{}}emit(i,t){let e=this._eventCallbacks[i];const n={bubbles:!1,cancelable:!1,detail:t},a=new CustomEvent(i,n);e&&e.forEach(s=>s.call(this,a)),this.element&&(this.element.dispatchEvent(a),Z(this.element,i,a))}addEventListener(i,t){return this.allowedEvents&&this.allowedEvents.indexOf(i)<0||typeof t!="function"?!1:(this._eventCallbacks[i]||(this._eventCallbacks[i]=[]),this._eventCallbacks[i].push(t),this)}removeEventListener(i,t){if(!this._eventCallbacks||arguments.length===0)return this._eventCallbacks={},this;let e=this._eventCallbacks[i];return e?arguments.length===1?(delete this._eventCallbacks[i],this):(this._eventCallbacks[i]=e.filter(n=>n!==t),this):this}}let g=[];const w="birthdaypicker",E="data-"+w,$=["short","long","numeric"],z=["ymd","ydm","myd","mdy","dmy","dym"],T="init",b="datechange",A="daychange",x="monthchange",S="yearchange",k="kill",F="option",p={y:"year",m:"month",d:"day"},N=new Date,_={y:N.getFullYear(),m:N.getMonth()+1,d:N.getDate()};let C=!1;const D=r=>r===!0||r==="true"||r===1||r==="1";class o extends q{constructor(t,e){if(!t)return{error:!0};if(t=typeof t=="string"?document.querySelector(t):t,t===null||t.length===0)return{error:!0};super();j(this,"_onSelect",t=>{t.target===this._year.el?this._yearWasChanged(+t.target.value):t.target===this._month.el?this._monthWasChanged(+t.target.value):t.target===this._day.el&&this._dayWasChanged(+t.target.value),this._dateChanged()});if(t.dataset.bdpInit)return o.getInstance(t);t.dataset.bdpInit=!0,this.allowedEvents=[T,b,A,x,S,k],g.push(this),L.put(t,"instance",this);const n=B(t,w,o.defaults);this.options=e||{},this.settings=Object.assign({},o.defaults,n,e),this.element=t,this.state=0,this.settings.autoInit&&this.init()}_triggerEvent(t,e){e=W({instance:this,year:+this.currentYear,month:+this.currentMonth,day:+this.currentDay,date:this.getDate()},e),this.emit(t,e)}_parseDate(t){typeof t!="object"&&(t=t.replaceAll("-","/"));const e=Date.parse(t);if(isNaN(e))return!1;t=new Date(e);const n=t.getFullYear(),a=t.getMonth()+1,s=t.getDate();return{year:n,month:a,day:s}}_getIdx(t,e){if(!(!t||isNaN(e||typeof e=="undefined"))){for(let n=0,a;n<t.length;n++)if(a=t[n],+a.value==+e)return n}}_updateSelectBox(t,e){const n=this[t].el;n.selectedIndex=this._getIdx(n.childNodes,e)}_setYear(t){return t=M(t,this._yearFrom,this._yearTo),this.currentYear===t?!1:(this._updateSelectBox("_year",t),this._yearWasChanged(t,!1),!0)}_setMonth(t){return t=M(t,1,12),this.currentMonth===t?!1:(this._updateSelectBox("_month",t),this._monthWasChanged(t,!1),!0)}_setDay(t){return t=M(t,1,this._getDaysPerMonth()),this.currentDay===t?!1:(this._updateSelectBox("_day",t),this._dayWasChanged(t,!1),!0)}_getDateInRange({year:t=this.currentYear,month:e=this.currentMonth,day:n=this.currentDay}){const a=this._lowerLimit,s=this._upperLimit;return t>s.year||t>=s.year&&e>s.month||t>=s.year&&e>=s.month&&n>s.day?s:t<a.year||t<=a.year&&e<a.month||t<=a.year&&e<=a.month&&n<a.day?a:{year:t,month:e,day:n}}_setDate(t,e=!1){t=this._getDateInRange(t);let n=this._setYear(t.year),a=this._setMonth(t.month),s=this._setDay(t.day);return(n||a||s)&&this._dateChanged(e),t}_getMonthText(t){return this.settings.monthFormat!=="numeric"?t:this.settings.leadingZero&&+t<10?"0"+t:""+t}_checkArrangement(t){return t=t.toLowerCase(),z.indexOf(t)<0?"ymd":t}_mapSelectBoxes(){let t=this.element.querySelectorAll("select");const e={};if(t.length===0)return e;let n=this.settings.arrange.split("");return n.forEach(a=>{const s=p[a];let h=this.settings[s+"El"]||"["+E+"-"+s+"]";if(h){let c;if(typeof h.nodeName!="undefined"?c=h:c=this.element.querySelector(h),c){e[s]=c,n=n.filter(u=>u!==a),t=Object.values(t).filter(u=>u!==c);return}}t=Object.values(t).filter(c=>{const u=c.attributes[E+"-"+s];return u&&(e[s]=c,n=n.filter(m=>m!==a)),!u})}),n.forEach((a,s)=>{const h=p[a];e[h]=t[s]}),e}_create(){const t=this.settings;t.arrange=this._checkArrangement(t.arrange);const e=this._mapSelectBoxes();t.arrange.split("").forEach(s=>{const h=p[s];let c=!1,u=e[h];(!u||u.dataset.init)&&(u=y("select"),c=!0,this.element.append(u)),u.setAttribute("aria-label",`select ${h}`),t.className&&(u.classList.add(t.className),u.classList.add(`${t.className}-${h}`)),u.dataset.init=!0;const m="change",I=this._onSelect,O=!1;u.addEventListener(m,I,O),this._registeredEventListeners.push({element:u,eventName:m,listener:I,option:O}),this["_"+h]={el:u,name:h,created:c,df:document.createDocumentFragment()},this._date.push(this["_"+h])});const n=y(F);t.placeholder&&this._date.forEach(s=>{const h=o.i18n[t.locale][s.name],c=n.cloneNode();c.innerHTML=h,s.df.appendChild(c)});for(let s=this._yearTo;s>=this._yearFrom;s--){const h=n.cloneNode();h.value=s,h.innerHTML=s,this._year.df.append(h)}this.monthFormat[t.monthFormat].forEach((s,h)=>{const c=n.cloneNode();c.value=h+1,c.innerHTML=this._getMonthText(s),this._month.df.append(c)});let a;for(let s=1;s<=31;s++){a=t.leadingZero&&s<10?"0"+s:s;const h=y(F,{value:s},"",a);this._day.df.append(h)}this._date.forEach(s=>s.el.append(s.df))}_updateDays(t=this.currentMonth){let e=this._getDaysPerMonth(t);const n=this.settings.placeholder?1:0,a=this._day.el.children.length-n;if(e!==a)if(typeof e=="undefined"&&(e=31),e-a>0)for(let s=a;s<e;s++){let h=y(F,{value:s+1},"",""+(s+1));this._day.el.append(h)}else{for(let s=a;s>e;s--)this._day.el.children[s+n-1].remove();this.currentDay>e&&(this.settings.roundDownDay?this._setDay(e):this._dayWasChanged(void 0))}}_disable(t,e,n){const a=e==="<"?s=>s<n:s=>s>n;this[t].el.childNodes.forEach(s=>{a(+s.value)&&(s.disabled=!0,this._disabled.push(s))})}_noFutureDate(t=this._lowerLimit,e=this._upperLimit){const n=()=>{this.currentYear>e.year&&this._setYear(e.year),this._disable("_month",">",e.month);const s=this.currentMonth>e.month;s&&this._setMonth(e.month),e.month===this.currentMonth&&(this._disable("_day",">",e.day),(s||this.currentDay>e.day)&&this._setDay(e.day))},a=()=>{this.currentYear<t.year&&this._setYear(t.year),this._disable("_month","<",t.month);const s=this.currentMonth<t.month;s&&this._setMonth(t.month),t.month===this.currentMonth&&(this._disable("_day","<",t.day),(s||this.currentDay<t.day)&&this._setDay(t.day))};return this._disabled.length&&(this._disabled.forEach(s=>{s.disabled=!1}),this._disabled=[]),this.currentYear<e.year&&this.currentYear>t.year||!this.currentYear||!this.currentYear&&!this.currentMonth&&!this.currentDay?!1:(this.currentYear>=e.year?n():this.currentYear<=t.year&&a(),!0)}_yearWasChanged(t,e=!0){this.currentYear=t,this._daysPerMonth[1]=v(t)?29:28,e&&this._triggerEvent(S),this.currentMonth===2&&this._updateDays()}_monthWasChanged(t,e=!0){this.currentMonth=t,e&&this._triggerEvent(x),this._updateDays()}_dayWasChanged(t,e=!0){this.currentDay=t,e&&this._triggerEvent(A)}_dateChanged(t=!0){this.settings.selectFuture||this._noFutureDate(this._lowerLimit,this._upperLimit),t&&this._triggerEvent(b),this.element.value=this.getDateString()}_updateDayList(){const t=this.settings.placeholder?1:0,e=this.settings.leadingZero?"0":"";for(let n=t;n<9+t;n++)this._day.el.childNodes[n].innerHTML=e+n}_updateMonthList(){const t=this.settings.monthFormat,e=this.settings.placeholder?1:0;this.monthFormat[t].forEach((n,a)=>{this._month.el.childNodes[a+e].innerHTML=this._getMonthText(n)})}useLeadingZero(t){t=D(t),t!==this.settings.leadingZero&&(this.settings.leadingZero=t,this.settings.monthFormat==="numeric"&&this._updateMonthList(),this._updateDayList())}_getDaysPerMonth(t=this.currentMonth){return this._daysPerMonth[+t-1]}setMonthFormat(t){return!this.monthFormat[t]||t===this.settings.monthFormat?!1:(this.settings.monthFormat=t,this._updateMonthList(),!0)}setLanguage(t){if(t===this.settings.locale||(""+t).length<2||(""+t).length>2)return!1;o.createLocale(t);const e=o.i18n[t];if(this.settings.placeholder&&this._date.forEach(a=>{a.el.childNodes[0].innerHTML=e[a.name]}),this.monthFormat=e.monthFormat,this.settings.locale=t,this.settings.monthFormat==="numeric")return!1;let n=this.settings.placeholder?1:0;this.monthFormat[this.settings.monthFormat].forEach((a,s)=>{this._month.el.childNodes[n+s].innerHTML=a})}setDate(t,e=!1){let n=this._parseDate(t);return n&&(n=this._setDate(n,e)),n}resetDate(t=!1){let e="";this.startDate&&t?(this._setDate(this.startDate),e=this.getDateString()):this._setDate({year:NaN,month:NaN,day:NaN}),this.element.value=e,this._triggerEvent(b)}kill(){this._registeredEventListeners&&this._registeredEventListeners.forEach(t=>t.element.removeEventListener(t.eventName,t.listener,t.option)),this._date.forEach(t=>{if(t.created)t.el.remove();else{const e=this.settings.className;e&&(t.el.classList.remove(e),Object.values(p).forEach(n=>{t.el.classList.remove(`${e}-${n}`)}))}}),this._triggerEvent(k)}isLeapYear(t=this.currentYear){return t===void 0?void 0:v(t)}getAge(){if(isNaN(this.currentYear)||isNaN(this.currentMonth)||isNaN(this.currentDay))return"";const t=this.currentYear,e=this.currentMonth,n=this.currentDay,a=new Date,s=a.getMonth()+1;let h=a.getFullYear()-t;return s<e||s===e&&a.getDate()<n?--h:h}getDateString(t){if(!t){const n=this.getDate();return n&&n.toLocaleDateString(this.settings.locale)}if(!this.currentYear||!this.currentMonth||!this.currentDay)return"";let e=t.toLowerCase();return e=e.replace(/yyyy/g,this.currentYear),e=e.replace(/yy/g,(""+this.currentYear).slice(2)),e=e.replace(/mm/g,("0"+this.currentMonth).slice(-2)),e=e.replace(/m/g,this.currentMonth),e=e.replace(/dd/g,("0"+this.currentDay).slice(-2)),e=e.replace(/d/g,this.currentDay),e}getDate(){return!this.currentYear||!this.currentMonth||!this.currentDay?"":new Date(Date.UTC(this.currentYear,+this.currentMonth-1,this.currentDay))}_getUpperLimit(t){if(t.upperLimit)return t.upperLimit;let e;return t.maxYear==="now"?(e=_.y-+t.minAge,{year:e,month:_.m,day:_.d}):(e=t.maxYear,{year:e,month:12,day:31})}_getLowerLimit(t){if(t.lowerLimit)return t.lowerLimit;let e;return t.minYear!==null?(e=+t.minYear,{year:e,month:1,day:1}):(e=(t.maxYear==="now"?_.y:t.maxYear)-+t.maxAge,{year:e,month:_.m,day:_.d})}init(){if(this.initialized)return!0;this.initialized=!0,this._registeredEventListeners=[],this._daysPerMonth=[31,28,31,30,31,30,31,31,30,31,30,31],this._date=[],this._disabled=[];const t=this.settings;t.placeholder=D(t.placeholder),t.leadingZero=D(t.leadingZero),t.selectFuture=D(t.selectFuture),this._lowerLimit=this._getLowerLimit(t),this._upperLimit=this._getUpperLimit(t),this._yearFrom=this._lowerLimit.year,this._yearTo=this._upperLimit.year;const[e]=o.createLocale(t.locale);if(t.locale=e,this.monthFormat=o.i18n[t.locale].monthFormat,this.allowedEvents.forEach(n=>{t[n]&&this.addEventListener(n,t[n])}),this._create(),t.defaultDate){const n=this.setDate(t.defaultDate==="now"?new Date().toString():t.defaultDate,!0);this.startDate=n}this.state=1,this._triggerEvent(T)}}return o.i18n={},o.currentLocale="en",o.getInstance=r=>L.get(r,"instance"),o.createLocale=r=>{if((!r||r.length!==2)&&(r="en"),o.i18n[r])return[r,o.i18n[r]];let i=new Date("2000-01-15"),t={monthFormat:{}};for(let a=0;a<12;a++)i.setMonth(a),$.forEach(s=>{t.monthFormat[s]=t.monthFormat[s]||[],t.monthFormat[s].push(i.toLocaleDateString(r,{month:s}))});const e="BirthdayPickerLocale";let n=l[r]?l[r]:l.en;return window[e]&&window[e][r]&&(n=Object.assign({},n,window[e][r])),o.i18n[r]=Object.assign(t,n),[r,t]},o.setMonthFormat=r=>{g.forEach(i=>{i.setMonthFormat(r)})},o.setLanguage=r=>{o.currentLocale=r,g.forEach(i=>{i.setLanguage(r)})},o.killAll=()=>g.length?(g.forEach(r=>{o.kill(r)}),g=[],!0):!1,o.kill=r=>{if(!r||(r.element||(r=o.getInstance(r)),!r))return!1;r.kill();const i=r.element;return i.dataset.bdpInit=!1,delete i.dataset.bdpInit,L.remove(i,"instance"),C=!1,!0},o.defaults=d,o.init=()=>{if(C)return!1;C=!0,o.createLocale(o.currentLocale);let r=document.querySelectorAll("["+E+"]");return r.length===0?!1:(r.forEach(i=>{new o(i)}),g)},o});
