/*!
* BirthdayPicker v0.2.2
* https://lemon3.github.io/birthdaypicker
*/
(function(u,c){typeof exports=="object"&&typeof module!="undefined"?module.exports=c():typeof define=="function"&&define.amd?define(c):(u=typeof globalThis!="undefined"?globalThis:u||self,u.BirthdayPicker=c())})(this,function(){"use strict";var G=Object.defineProperty;var H=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var Y=(u,c,d)=>c in u?G(u,c,{enumerable:!0,configurable:!0,writable:!0,value:d}):u[c]=d,_=(u,c)=>{for(var d in c||(c={}))J.call(c,d)&&Y(u,d,c[d]);if(H)for(var d of H(c))U.call(c,d)&&Y(u,d,c[d]);return u};var f=(u,c,d)=>Y(u,typeof c!="symbol"?c+"":c,d);const u={minAge:0,maxAge:100,minYear:null,maxYear:"now",lowerLimit:null,upperLimit:null,monthFormat:"short",placeholder:!0,className:null,defaultDate:null,autoInit:!0,leadingZero:!0,locale:"en",selectFuture:!1,arrange:"ymd",yearEl:null,monthEl:null,dayEl:null,roundDownDay:!0},c={en:{year:"Year",month:"Month",day:"Day"},de:{year:"Jahr",month:"Monat",day:"Tag"},fr:{year:"AnnÃ©e",month:"Mois",day:"Jour"}},d=(o,a,t,e)=>{if(a)for(const s in a)o.setAttribute(s,a[s]);if(t)for(const s in t)o.style[s]=t[s];return e&&(o.innerHTML=e),o},y=(o,a,t,e)=>d(document.createElement(o),a,t,e),W=(o,a,t=null)=>{if(!o)return!1;if(o.dataset[a]===void 0)return o.dataset;let e;try{o.dataset[a]!=="undefined"&&o.dataset[a].indexOf("{")>=0&&(e=JSON.parse(o.dataset[a].replace(/'/g,'"')))}catch(r){console.error(r)}if(typeof e!="object"){e=o.dataset[a];const r={};e=e.replace(/ /g,"");const i=e.split(",");i.length>1?i.forEach(l=>{const[g,z]=l.split(":");r[g.replace(/'/g,"")]=z.replace(/'/g,"")}):r[a]=e,e=r}let s={},n=a.length;return Object.entries(o.dataset).forEach(r=>{if(r[0].toLowerCase().indexOf(a)>=0&&r[0].length>n){let i=r[0][n].toLowerCase()+r[0].substring(n+1);(t===null||t&&t[i]!==void 0)&&(s[i]=r[1])}}),Object.assign(e,s)},v=o=>+o%4===0&&+o%100!==0||+o%400===0,E={_s:new WeakMap,put(o,...a){this._s.has(o)||this._s.set(o,new Map);let t=this._s.get(o);if(a.length>1)return t.set(a[0],a[1]),this;if(typeof a[0]=="object")for(const e in a[0])t.set(e,a[0][e]);else t.set(a[0]);return this},get(o,a){return this._s.has(o)?a?this._s.get(o).get(a):this._s.get(o):!1},has(o,a){return this._s.has(o)&&this._s.get(o).has(a)},remove(o,a){if(!this._s.has(o))return!1;let t=this._s.get(o).delete(a);return this._s.get(o).size===0&&this._s.delete(o),t}},M=(o,a,t)=>{if(o=parseFloat(o,10),isNaN(o))return NaN;if(a=parseFloat(a,10),t=parseFloat(t,10),t<a){let e=t;t=a,a=e}return!isNaN(a)&&o<a?a:!isNaN(t)&&o>t?t:o},D=o=>o===!0||o==="true"||o===1||o==="1",$=(o,a,t)=>{let e=o.getAttribute("on"+a);new Function("e","{"+e+"}").call(o,t)};class Z{constructor(){this._eventCallbacks=this._eventCallbacks||{}}emit(a,t){let e=this._eventCallbacks[a];const s={bubbles:!1,cancelable:!1,detail:t},n=new CustomEvent(a,s);e&&e.forEach(r=>r.call(this,n)),this.element&&(this.element.dispatchEvent(n),$(this.element,a,n))}addEventListener(a,t){return this.allowedEvents&&this.allowedEvents.indexOf(a)<0||typeof t!="function"?!1:(this._eventCallbacks[a]||(this._eventCallbacks[a]=[]),this._eventCallbacks[a].push(t),this)}removeEventListener(a,t){if(!this._eventCallbacks||arguments.length===0)return this._eventCallbacks={},this;let e=this._eventCallbacks[a];return e?arguments.length===1?(delete this._eventCallbacks[a],this):(this._eventCallbacks[a]=e.filter(s=>s!==t),this):this}}let m=[];const S="birthdaypicker",T="data-"+S,j=["short","long","numeric"],q=["ymd","ydm","myd","mdy","dmy","dym"],x="init",w="datechange",A="daychange",I="monthchange",O="yearchange",k="kill",N="option",L={y:"year",m:"month",d:"day"},F=new Date,p={y:F.getFullYear(),m:F.getMonth()+1,d:F.getDate()};let b=!1;const h=class h extends Z{constructor(t,e){if(!t)return{error:!0};if(t=typeof t=="string"?document.querySelector(t):t,t===null||t.length===0)return{error:!0};super();f(this,"_onSelect",t=>{t.target===this._year.el?this._yearWasChanged(+t.target.value):t.target===this._month.el?this._monthWasChanged(+t.target.value):t.target===this._day.el&&this._dayWasChanged(+t.target.value),this._dateChanged()});if(t.dataset.bdpInit)return h.getInstance(t);t.dataset.bdpInit=!0,this.allowedEvents=[x,w,A,I,O,k],m.push(this),E.put(t,"instance",this);const s=W(t,S,h.defaults);this.options=e||{},this.settings=Object.assign({},h.defaults,s,e),this.element=t,this.state=0,this.settings.autoInit&&this.init()}_triggerEvent(t,e){e=_({instance:this,year:+this.currentYear,month:+this.currentMonth,day:+this.currentDay,date:this.getDate()},e),this.emit(t,e)}_parseDate(t){if(t instanceof Date&&!isNaN(t))return{year:t.getFullYear(),month:t.getMonth()+1,day:t.getDate()};if(typeof t!="string"||!t.trim())return!1;const e=new Date(t.replace(/-/g,"/"));return isNaN(e)?!1:{year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate()}}_getIdx(t,e){if(!(t instanceof NodeList)||e===void 0||e===null)return;const s=isNaN(e)?e:+e,n=Array.from(t).findIndex(r=>+r.value===s);return n!==-1?n:void 0}_updateSelectBox(t,e){const s=this[t].el;s.selectedIndex=this._getIdx(s.childNodes,e)}_setYear(t){return t=M(t,this._yearFrom,this._yearTo),this.currentYear===t?!1:(this._updateSelectBox("_year",t),this._yearWasChanged(t,!1),!0)}_setMonth(t){return t=M(t,1,12),this.currentMonth===t?!1:(this._updateSelectBox("_month",t),this._monthWasChanged(t,!1),!0)}_setDay(t){return t=M(t,1,this._getDaysPerMonth()),this.currentDay===t?!1:(this._updateSelectBox("_day",t),this._dayWasChanged(t,!1),!0)}_getDateInRange({year:t=this.currentYear,month:e=this.currentMonth,day:s=this.currentDay}={}){const n=this._lowerLimit,r=this._upperLimit;if(!n||!r)throw new Error("Lower and upper date limits must be defined.");const i=new Date(t,e-1,s),l=new Date(n.year,n.month-1,n.day),g=new Date(r.year,r.month-1,r.day);return i>g?r:i<l?n:{year:t,month:e,day:s}}_setDate(t,e=!1){t=this._getDateInRange(t);let s=this._setYear(t.year),n=this._setMonth(t.month),r=this._setDay(t.day);return(s||n||r)&&this._dateChanged(e),t}_getMonthText(t){return this.settings.monthFormat!=="numeric"?t:this.settings.leadingZero?String(t).padStart(2,"0"):String(t)}_checkArrangement(t){return t=t.toLowerCase(),q.includes(t)?t:"ymd"}_mapSelectBoxes(){const t=this.element.querySelectorAll("select");if(!t.length)return{};const e={},s=this.settings.arrange.split(""),n=s.map(i=>L[i]);n.forEach(i=>{const l=this.settings[`${i}El`]||`[${T}-${i}]`,g=l.nodeName?l:this.element.querySelector(l);g&&g.tagName==="SELECT"&&(e[i]=g,s.splice(s.indexOf(n.indexOf(i).toString()),1))});const r=Array.from(t).filter(i=>!Object.values(e).includes(i));return s.forEach((i,l)=>{const g=L[i];e[g]=r[l]}),e}_create(){const t=this.settings;t.arrange=this._checkArrangement(t.arrange);const e=this._mapSelectBoxes();t.arrange.split("").forEach(n=>{const r=L[n];let i=e[r];(!i||i.dataset.init)&&(i=y("select"),this.element.append(i)),i.setAttribute("aria-label",`select ${r}`),t.className&&i.classList.add(t.className,`${t.className}-${r}`),i.dataset.init=!0;const l=this._onSelect;i.addEventListener("change",l,!1),this._registeredEventListeners.push({element:i,eventName:"change",listener:l,option:!1}),this[`_${r}`]={el:i,name:r,created:!e[r],df:document.createDocumentFragment()},this._date.push(this[`_${r}`])});const s=y(N);t.placeholder&&this._date.forEach(n=>{const r=h.i18n[t.locale][n.name],i=s.cloneNode();i.innerHTML=r,n.df.appendChild(i)});for(let n=this._yearTo;n>=this._yearFrom;n--){const r=s.cloneNode();r.value=n,r.innerHTML=n,this._year.df.append(r)}this.monthFormat[t.monthFormat].forEach((n,r)=>{const i=s.cloneNode();i.value=r+1,i.innerHTML=this._getMonthText(n),this._month.df.append(i)});for(let n=1;n<=31;n++){const r=t.leadingZero&&n<10?`0${n}`:n,i=y(N,{value:n},"",r);this._day.df.append(i)}this._date.forEach(n=>n.el.append(n.df))}_updateDays(t=this.currentMonth){const e=this._getDaysPerMonth(t)||31,s=this.settings.placeholder?1:0,n=this._day.el.children.length-s;if(e===n)return;const r=e-n;if(r>0)for(let i=n+1;i<=e;i++){const l=y(N,{value:i},"",i);this._day.el.append(l)}else{for(let i=0;i<-r;i++)this._day.el.children[n+s-i-1].remove();this.currentDay>e&&(this.settings.roundDownDay?this._setDay(e):this._dayWasChanged())}}_disable(t,e,s){const n=e==="<";this[t].el.childNodes.forEach(r=>{(n&&+r.value<s||!n&&+r.value>s)&&(r.disabled=!0,this._disabled.push(r))})}_noFutureDate(t=this._lowerLimit,e=this._upperLimit){if(this._disabled.forEach(l=>{l.disabled=!1}),this._disabled=[],this.currentYear>t.year&&this.currentYear<e.year||!this.currentYear||!this.currentYear&&!this.currentMonth&&!this.currentDay)return!1;const s=this.currentYear>=e.year,n=s?e.year:t.year,r=s?e.month:t.month,i=s?e.day:t.day;return this.currentYear!==n&&this._setYear(n),this._disable("_month",s?">":"<",r),this.currentMonth!==r&&this._setMonth(r),this.currentMonth===r&&(this._disable("_day",s?">":"<",i),this.currentDay!==i&&this._setDay(i)),!0}_yearWasChanged(t,e=!0){this.currentYear=t,this._daysPerMonth[1]=v(t)?29:28,e&&this._triggerEvent(O),this.currentMonth===2&&this._updateDays()}_monthWasChanged(t,e=!0){this.currentMonth=t,e&&this._triggerEvent(I),this._updateDays()}_dayWasChanged(t,e=!0){this.currentDay=t,e&&this._triggerEvent(A)}_dateChanged(t=!0){this.settings.selectFuture||this._noFutureDate(this._lowerLimit,this._upperLimit),t&&this._triggerEvent(w),this.element.value=this.getDateString()}_updateDayList(){const t=this.settings.placeholder?1:0,e=this.settings.leadingZero?"0":"";for(let s=t;s<9+t;s++)this._day.el.childNodes[s].innerHTML=e+s}_updateMonthList(){const t=this.settings.placeholder?1:0,e=this.settings.monthFormat;this.monthFormat[e].forEach((s,n)=>{this._month.el.childNodes[n+t].innerHTML=this._getMonthText(s)})}useLeadingZero(t){t=D(t),t!==this.settings.leadingZero&&(this.settings.leadingZero=t,this.settings.monthFormat==="numeric"&&this._updateMonthList(),this._updateDayList())}_getDaysPerMonth(t=this.currentMonth){return this._daysPerMonth[+t-1]}setMonthFormat(t){return!this.monthFormat[t]||t===this.settings.monthFormat?!1:(this.settings.monthFormat=t,this._updateMonthList(),!0)}setLanguage(t){if(t===this.settings.locale||(""+t).length<2||(""+t).length>2)return!1;h.createLocale(t);const e=h.i18n[t];if(this.settings.placeholder&&this._date.forEach(n=>{n.el.childNodes[0].innerHTML=e[n.name]}),this.monthFormat=e.monthFormat,this.settings.locale=t,this.settings.monthFormat==="numeric")return!1;let s=this.settings.placeholder?1:0;this.monthFormat[this.settings.monthFormat].forEach((n,r)=>{this._month.el.childNodes[s+r].innerHTML=n})}setDate(t,e=!1){let s=this._parseDate(t);return s&&(s=this._setDate(s,e)),s}resetDate(t=!1){const e=t&&this.startDate?this.startDate:{year:NaN,month:NaN,day:NaN};this._setDate(e),this.element.value=this.getDateString(),this._triggerEvent(w)}kill(){var t;(t=this._registeredEventListeners)==null||t.forEach(e=>e.element.removeEventListener(e.eventName,e.listener,e.option)),this._date.forEach(e=>{if(e.created)e.el.remove();else{const s=this.settings.className;s&&e.el.classList.remove(s,...Object.values(L).map(n=>`${s}-${n}`))}}),this._triggerEvent(k)}isLeapYear(t=this.currentYear){return t===void 0?void 0:v(t)}getAge(){if(isNaN(this.currentYear)||isNaN(this.currentMonth)||isNaN(this.currentDay))return"";const t=this.currentYear,e=this.currentMonth,s=this.currentDay,n=new Date,r=n.getMonth()+1;return n.getFullYear()-t-(r<e||r===e&&n.getDate()<s?1:0)}getDateString(t){if(!t){const r=this.getDate();return r&&r.toLocaleDateString(this.settings.locale)}if(!this.currentYear||!this.currentMonth||!this.currentDay)return"";const e=this.currentYear,s=String(this.currentMonth).padStart(2,"0"),n=String(this.currentDay).padStart(2,"0");return t.toLowerCase().replace(/yyyy/g,e).replace(/yy/g,e.toString().slice(2)).replace(/mm/g,s).replace(/m/g,this.currentMonth).replace(/dd/g,n).replace(/d/g,this.currentDay)}getDate(){return!this.currentYear||!this.currentMonth||!this.currentDay?"":new Date(Date.UTC(this.currentYear,+this.currentMonth-1,this.currentDay))}_getUpperLimit(t){if(t.upperLimit)return t.upperLimit;let e;return t.maxYear==="now"?(e=p.y-+t.minAge,{year:e,month:p.m,day:p.d}):(e=t.maxYear,{year:e,month:12,day:31})}_getLowerLimit(t){if(t.lowerLimit)return t.lowerLimit;let e;return t.minYear!==null?(e=+t.minYear,{year:e,month:1,day:1}):(e=(t.maxYear==="now"?p.y:t.maxYear)-+t.maxAge,{year:e,month:p.m,day:p.d})}init(){if(this.initialized)return!0;this.initialized=!0,this._registeredEventListeners=[],this._daysPerMonth=[31,28,31,30,31,30,31,31,30,31,30,31],this._date=[],this._disabled=[];const t=this.settings;t.placeholder=D(t.placeholder),t.leadingZero=D(t.leadingZero),t.selectFuture=D(t.selectFuture),this._lowerLimit=this._getLowerLimit(t),this._upperLimit=this._getUpperLimit(t),this._yearFrom=this._lowerLimit.year,this._yearTo=this._upperLimit.year;const[e]=h.createLocale(t.locale);if(t.locale=e,this.monthFormat=h.i18n[t.locale].monthFormat,this.allowedEvents.forEach(s=>{t[s]&&this.addEventListener(s,t[s])}),this._create(),t.defaultDate){const s=this.setDate(t.defaultDate==="now"?new Date().toString():t.defaultDate,!0);this.startDate=s}this.state=1,this._triggerEvent(x)}};f(h,"currentLocale","en"),f(h,"i18n",{}),f(h,"createLocale",(t="en")=>{if(t.length!==2&&(t="en"),h.i18n[t])return[t,h.i18n[t]];const e=new Date("2000-01-15"),s={monthFormat:{}};j.forEach(i=>{s.monthFormat[i]=[];for(let l=0;l<12;l++)e.setMonth(l),s.monthFormat[i].push(e.toLocaleDateString(t,{month:i}))});const n="BirthdayPickerLocale",r=_(_({},c[t]||c.en),window[n]&&window[n][t]);return h.i18n[t]=_(_({},s),r),[t,h.i18n[t]]}),f(h,"getInstance",t=>E.get(t,"instance")),f(h,"setMonthFormat",t=>{m.forEach(e=>{e.setMonthFormat(t)})}),f(h,"setLanguage",t=>{h.currentLocale=t,m.forEach(e=>{e.setLanguage(t)})}),f(h,"killAll",()=>m.length?(m.forEach(t=>{h.kill(t)}),m=[],!0):!1),f(h,"kill",t=>{if(!t||(t.element||(t=h.getInstance(t)),!t))return!1;t.kill();const e=t.element;return e.dataset.bdpInit=!1,delete e.dataset.bdpInit,E.remove(e,"instance"),b=!1,!0}),f(h,"defaults",u),f(h,"init",()=>{if(b)return!1;b=!0,h.createLocale(h.currentLocale);let t=document.querySelectorAll("["+T+"]");return t.length===0?!1:(t.forEach(e=>{new h(e)}),m)});let C=h;return C});
