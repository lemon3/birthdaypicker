/*!
* BirthdayPicker v0.2.0
* https://lemon3.github.io/birthdaypicker
*/
(function(u,c){typeof exports=="object"&&typeof module!="undefined"?module.exports=c():typeof define=="function"&&define.amd?define(c):(u=typeof globalThis!="undefined"?globalThis:u||self).BirthdayPicker=c()}(this,function(){"use strict";var q=Object.defineProperty;var I=Object.getOwnPropertySymbols;var z=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var Y=(u,c,g)=>c in u?q(u,c,{enumerable:!0,configurable:!0,writable:!0,value:g}):u[c]=g,j=(u,c)=>{for(var g in c||(c={}))z.call(c,g)&&Y(u,g,c[g]);if(I)for(var g of I(c))J.call(c,g)&&Y(u,g,c[g]);return u};var O=(u,c,g)=>(Y(u,typeof c!="symbol"?c+"":c,g),g);ifconst u={en:{year:"Year",month:"Month",day:"Day"},de:{year:"Jahr",month:"Monat",day:"Tag"},fr:{year:"AnnÃ©e",month:"Mois",day:"Jour"}},c=(a,i,e,t)=>((r,n,s,h)=>{if(n)for(const o in n)r.setAttribute(o,n[o]);if(s)for(const o in s)r.style[o]=s[o];return h&&(r.innerHTML=h),r})(document.createElement(a),i,e,t),g=a=>+a%4==0&&+a%100!=0||+a%400==0,L={_s:new WeakMap,put(a,...i){this._s.has(a)||this._s.set(a,new Map);let e=this._s.get(a);if(i.length>1)return e.set(i[0],i[1]),this;if(typeof i[0]=="object")for(const t in i[0])e.set(t,i[0][t]);else e.set(i[0]);return this},get(a,i){return!!this._s.has(a)&&(i?this._s.get(a).get(i):this._s.get(a))},has(a,i){return this._s.has(a)&&this._s.get(a).has(i)},remove(a,i){if(!this._s.has(a))return!1;let e=this._s.get(a).delete(i);return this._s.get(a).size===0&&this._s.delete(a),e}},b=(a,i,e)=>{if(a=parseFloat(a,10),isNaN(a))return NaN;if(i=parseFloat(i,10),(e=parseFloat(e,10))<i){let t=e;e=i,i=t}return!isNaN(i)&&a<i?i:!isNaN(e)&&a>e?e:a};class W{constructor(){this._eventCallbacks=this._eventCallbacks||{}}emit(i,e){let t=this._eventCallbacks[i];const r=new CustomEvent(i,{bubbles:!1,cancelable:!1,detail:e});t&&t.forEach(n=>n.call(this,r)),this.element&&(this.element.dispatchEvent(r),((n,s,h)=>{let o=n.getAttribute("on"+s);new Function("e","{"+o+"}").call(n,h)})(this.element,i,r))}addEventListener(i,e){return!(this.allowedEvents&&this.allowedEvents.indexOf(i)<0||typeof e!="function")&&(this._eventCallbacks[i]||(this._eventCallbacks[i]=[]),this._eventCallbacks[i].push(e),this)}removeEventListener(i,e){if(!this._eventCallbacks||arguments.length===0)return this._eventCallbacks={},this;let t=this._eventCallbacks[i];return t?arguments.length===1?(delete this._eventCallbacks[i],this):(this._eventCallbacks[i]=t.filter(r=>r!==e),this):this}}let f=[];const C="birthdaypicker",E="data-"+C,Z=["short","long","numeric"],B=["ymd","ydm","myd","mdy","dmy","dym"],x="init",M="datechange",k="daychange",T="monthchange",S="yearchange",A="kill",N="option",D={y:"year",m:"month",d:"day"},w=new Date,p={y:w.getFullYear(),m:w.getMonth()+1,d:w.getDate()};let F=!1;const v=a=>a===!0||a==="true"||a===1||a==="1";class l extends W{constructor(e,t){if(!e)return{error:!0};if((e=typeof e=="string"?document.querySelector(e):e)===null||e.length===0)return{error:!0};super();O(this,"_onSelect",e=>{e.target===this._year.el?this._yearWasChanged(+e.target.value):e.target===this._month.el?this._monthWasChanged(+e.target.value):e.target===this._day.el&&this._dayWasChanged(+e.target.value),this._dateChanged()});if(e.dataset.bdpInit)return l.getInstance(e);e.dataset.bdpInit=!0,this.allowedEvents=[x,M,k,T,S,A],f.push(this),L.put(e,"instance",this);const r=((n,s,h=null)=>{if(!n)return!1;if(s===void 0||n.dataset[s]===void 0)return n.dataset;let o;try{o=JSON.parse(n.dataset[s].replace(/'/g,'"'))}catch(m){}if(typeof o!="object"){o=n.dataset[s];const m={};o=o.replace(/ /g,"");const _=o.split(",");_.length>1?_.forEach(H=>{const[P,$]=H.split(":");m[P.replace(/'/g,"")]=$.replace(/'/g,"")}):m[s]=o,o=m}let d={},y=s.length;return Object.entries(n.dataset).forEach(m=>{if(m[0].toLowerCase().indexOf(s)>=0&&m[0].length>y){let _=m[0][y].toLowerCase()+m[0].substring(y+1);(h===null||h&&h[_]!==void 0)&&(d[_]=m[1])}}),Object.assign(o,d)})(e,C,l.defaults);this.options=t||{},this.settings=Object.assign({},l.defaults,r,t),this.element=e,this.state=0,this.settings.autoInit&&this.init()}_triggerEvent(e,t){t=j({instance:this,year:+this.currentYear,month:+this.currentMonth,day:+this.currentDay,date:this.getDate()},t),this.emit(e,t)}_parseDate(e){typeof e!="object"&&(e=e.replaceAll("-","/"));const t=Date.parse(e);return isNaN(t)?!1:{year:(e=new Date(t)).getFullYear(),month:e.getMonth()+1,day:e.getDate()}}_getIdx(e,t){if(e&&!isNaN(t||t===void 0)){for(let r,n=0;n<e.length;n++)if(r=e[n],+r.value==+t)return n}}_updateSelectBox(e,t){const r=this[e].el;r.selectedIndex=this._getIdx(r.childNodes,t)}_setYear(e){return e=b(e,this._yearFrom,this._yearTo),this.currentYear!==e&&(this._updateSelectBox("_year",e),this._yearWasChanged(e,!1),!0)}_setMonth(e){return e=b(e,1,12),this.currentMonth!==e&&(this._updateSelectBox("_month",e),this._monthWasChanged(e,!1),!0)}_setDay(e){return e=b(e,1,this._getDaysPerMonth()),this.currentDay!==e&&(this._updateSelectBox("_day",e),this._dayWasChanged(e,!1),!0)}_getDateInRange({year:e=this.currentYear,month:t=this.currentMonth,day:r=this.currentDay}){const n=this._lowerLimit,s=this._upperLimit;return e>s.year||e>=s.year&&t>s.month||e>=s.year&&t>=s.month&&r>s.day?s:e<n.year||e<=n.year&&t<n.month||e<=n.year&&t<=n.month&&r<n.day?n:{year:e,month:t,day:r}}_setDate(e,t=!1){e=this._getDateInRange(e);let r=this._setYear(e.year),n=this._setMonth(e.month),s=this._setDay(e.day);return(r||n||s)&&this._dateChanged(t),e}_getMonthText(e){return this.settings.monthFormat!=="numeric"?e:this.settings.leadingZero&&+e<10?"0"+e:""+e}_checkArrangement(e){return e=e.toLowerCase(),B.indexOf(e)<0?"ymd":e}_mapSelectBoxes(){let e=this.element.querySelectorAll("select");const t={};if(e.length===0)return t;let r=this.settings.arrange.split("");return r.forEach(n=>{const s=D[n];let h=this.settings[s+"El"]||"["+E+"-"+s+"]";if(h){let o;if(o=h.nodeName!==void 0?h:this.element.querySelector(h),o)return t[s]=o,r=r.filter(d=>d!==n),void(e=Object.values(e).filter(d=>d!==o))}e=Object.values(e).filter(o=>{const d=o.attributes[E+"-"+s];return d&&(t[s]=o,r=r.filter(y=>y!==n)),!d})}),r.forEach((n,s)=>{t[D[n]]=e[s]}),t}_create(){const e=this.settings;e.arrange=this._checkArrangement(e.arrange);const t=this._mapSelectBoxes();e.arrange.split("").forEach(s=>{const h=D[s];let o=!1,d=t[h];d&&!d.dataset.init||(d=c("select"),o=!0,this.element.append(d)),d.setAttribute("aria-label",`select ${h}`),e.className&&(d.classList.add(e.className),d.classList.add(`${e.className}-${h}`)),d.dataset.init=!0;const y="change",m=this._onSelect,_=!1;d.addEventListener(y,m,_),this._registeredEventListeners.push({element:d,eventName:y,listener:m,option:_}),this["_"+h]={el:d,name:h,created:o,df:document.createDocumentFragment()},this._date.push(this["_"+h])});const r=c(N);e.placeholder&&this._date.forEach(s=>{const h=l.i18n[e.locale][s.name],o=r.cloneNode();o.innerHTML=h,s.df.appendChild(o)});for(let s=this._yearTo;s>=this._yearFrom;s--){const h=r.cloneNode();h.value=s,h.innerHTML=s,this._year.df.append(h)}let n;this.monthFormat[e.monthFormat].forEach((s,h)=>{const o=r.cloneNode();o.value=h+1,o.innerHTML=this._getMonthText(s),this._month.df.append(o)});for(let s=1;s<=31;s++){n=e.leadingZero&&s<10?"0"+s:s;const h=c(N,{value:s},"",n);this._day.df.append(h)}this._date.forEach(s=>s.el.append(s.df))}_updateDays(e=this.currentMonth){let t=this._getDaysPerMonth(e);const r=this.settings.placeholder?1:0,n=this._day.el.children.length-r;if(t!==n)if(t===void 0&&(t=31),t-n>0)for(let s=n;s<t;s++){let h=c(N,{value:s+1},"",""+(s+1));this._day.el.append(h)}else{for(let s=n;s>t;s--)this._day.el.children[s+r-1].remove();this.currentDay>t&&(this.settings.roundDownDay?this._setDay(t):this._dayWasChanged(void 0))}}_disable(e,t,r){const n=t==="<"?s=>s<r:s=>s>r;this[e].el.childNodes.forEach(s=>{n(+s.value)&&(s.disabled=!0,this._disabled.push(s))})}_noFutureDate(e=this._lowerLimit,t=this._upperLimit){const r=()=>{this.currentYear>t.year&&this._setYear(t.year),this._disable("_month",">",t.month);const s=this.currentMonth>t.month;s&&this._setMonth(t.month),t.month===this.currentMonth&&(this._disable("_day",">",t.day),(s||this.currentDay>t.day)&&this._setDay(t.day))},n=()=>{this.currentYear<e.year&&this._setYear(e.year),this._disable("_month","<",e.month);const s=this.currentMonth<e.month;s&&this._setMonth(e.month),e.month===this.currentMonth&&(this._disable("_day","<",e.day),(s||this.currentDay<e.day)&&this._setDay(e.day))};return this._disabled.length&&(this._disabled.forEach(s=>{s.disabled=!1}),this._disabled=[]),!(this.currentYear<t.year&&this.currentYear>e.year||!this.currentYear||!(this.currentYear||this.currentMonth||this.currentDay))&&(this.currentYear>=t.year?r():this.currentYear<=e.year&&n(),!0)}_yearWasChanged(e,t=!0){this.currentYear=e,this._daysPerMonth[1]=g(e)?29:28,t&&this._triggerEvent(S),this.currentMonth===2&&this._updateDays()}_monthWasChanged(e,t=!0){this.currentMonth=e,t&&this._triggerEvent(T),this._updateDays()}_dayWasChanged(e,t=!0){this.currentDay=e,t&&this._triggerEvent(k)}_dateChanged(e=!0){this.settings.selectFuture||this._noFutureDate(this._lowerLimit,this._upperLimit),e&&this._triggerEvent(M),this.element.value=this.getDateString()}_updateDayList(){const e=this.settings.placeholder?1:0,t=this.settings.leadingZero?"0":"";for(let r=e;r<9+e;r++)this._day.el.childNodes[r].innerHTML=t+r}_updateMonthList(){const e=this.settings.monthFormat,t=this.settings.placeholder?1:0;this.monthFormat[e].forEach((r,n)=>{this._month.el.childNodes[n+t].innerHTML=this._getMonthText(r)})}useLeadingZero(e){(e=v(e))!==this.settings.leadingZero&&(this.settings.leadingZero=e,this.settings.monthFormat==="numeric"&&this._updateMonthList(),this._updateDayList())}_getDaysPerMonth(e=this.currentMonth){return this._daysPerMonth[+e-1]}setMonthFormat(e){return!(!this.monthFormat[e]||e===this.settings.monthFormat)&&(this.settings.monthFormat=e,this._updateMonthList(),!0)}setLanguage(e){if(e===this.settings.locale||(""+e).length<2||(""+e).length>2)return!1;l.createLocale(e);const t=l.i18n[e];if(this.settings.placeholder&&this._date.forEach(n=>{n.el.childNodes[0].innerHTML=t[n.name]}),this.monthFormat=t.monthFormat,this.settings.locale=e,this.settings.monthFormat==="numeric")return!1;let r=this.settings.placeholder?1:0;this.monthFormat[this.settings.monthFormat].forEach((n,s)=>{this._month.el.childNodes[r+s].innerHTML=n})}setDate(e,t=!1){let r=this._parseDate(e);return r&&(r=this._setDate(r,t)),r}resetDate(e=!1){let t="";this.startDate&&e?(this._setDate(this.startDate),t=this.getDateString()):this._setDate({year:NaN,month:NaN,day:NaN}),this.element.value=t,this._triggerEvent(M)}kill(){this._registeredEventListeners&&this._registeredEventListeners.forEach(e=>e.element.removeEventListener(e.eventName,e.listener,e.option)),this._date.forEach(e=>{if(e.created)e.el.remove();else{const t=this.settings.className;t&&(e.el.classList.remove(t),Object.values(D).forEach(r=>{e.el.classList.remove(`${t}-${r}`)}))}}),this._triggerEvent(A)}isLeapYear(e=this.currentYear){return e===void 0?void 0:g(e)}getAge(){if(isNaN(this.currentYear)||isNaN(this.currentMonth)||isNaN(this.currentDay))return"";const e=this.currentYear,t=this.currentMonth,r=this.currentDay,n=new Date,s=n.getMonth()+1;let h=n.getFullYear()-e;return s<t||s===t&&n.getDate()<r?--h:h}getDateString(e){if(!e){const r=this.getDate();return r&&r.toLocaleDateString(this.settings.locale)}if(!this.currentYear||!this.currentMonth||!this.currentDay)return"";let t=e.toLowerCase();return t=t.replace(/yyyy/g,this.currentYear),t=t.replace(/yy/g,(""+this.currentYear).slice(2)),t=t.replace(/mm/g,("0"+this.currentMonth).slice(-2)),t=t.replace(/m/g,this.currentMonth),t=t.replace(/dd/g,("0"+this.currentDay).slice(-2)),t=t.replace(/d/g,this.currentDay),t}getDate(){return this.currentYear&&this.currentMonth&&this.currentDay?new Date(Date.UTC(this.currentYear,+this.currentMonth-1,this.currentDay)):""}_getUpperLimit(e){if(e.upperLimit)return e.upperLimit;let t;return e.maxYear==="now"?(t=p.y-+e.minAge,{year:t,month:p.m,day:p.d}):(t=e.maxYear,{year:t,month:12,day:31})}_getLowerLimit(e){if(e.lowerLimit)return e.lowerLimit;let t;return e.minYear!==null?(t=+e.minYear,{year:t,month:1,day:1}):(t=(e.maxYear==="now"?p.y:e.maxYear)-+e.maxAge,{year:t,month:p.m,day:p.d})}init(){if(this.initialized)return!0;this.initialized=!0,this._registeredEventListeners=[],this._daysPerMonth=[31,28,31,30,31,30,31,31,30,31,30,31],this._date=[],this._disabled=[];const e=this.settings;e.placeholder=v(e.placeholder),e.leadingZero=v(e.leadingZero),e.selectFuture=v(e.selectFuture),this._lowerLimit=this._getLowerLimit(e),this._upperLimit=this._getUpperLimit(e),this._yearFrom=this._lowerLimit.year,this._yearTo=this._upperLimit.year;const[t]=l.createLocale(e.locale);if(e.locale=t,this.monthFormat=l.i18n[e.locale].monthFormat,this.allowedEvents.forEach(r=>{e[r]&&this.addEventListener(r,e[r])}),this._create(),e.defaultDate){const r=this.setDate(e.defaultDate==="now"?new Date().toString():e.defaultDate,!0);this.startDate=r}this.state=1,this._triggerEvent(x)}}return l.i18n={},l.currentLocale="en",l.getInstance=a=>L.get(a,"instance"),l.createLocale=a=>{if(a&&a.length===2||(a="en"),l.i18n[a])return[a,l.i18n[a]];let i=new Date("2000-01-15"),e={monthFormat:{}};for(let n=0;n<12;n++)i.setMonth(n),Z.forEach(s=>{e.monthFormat[s]=e.monthFormat[s]||[],e.monthFormat[s].push(i.toLocaleDateString(a,{month:s}))});const t="BirthdayPickerLocale";let r=u[a]?u[a]:u.en;return window[t]&&window[t][a]&&(r=Object.assign({},r,window[t][a])),l.i18n[a]=Object.assign(e,r),[a,e]},l.setMonthFormat=a=>{f.forEach(i=>{i.setMonthFormat(a)})},l.setLanguage=a=>{l.currentLocale=a,f.forEach(i=>{i.setLanguage(a)})},l.killAll=()=>!!f.length&&(f.forEach(a=>{l.kill(a)}),f=[],!0),l.kill=a=>{if(!a||(a.element||(a=l.getInstance(a)),!a))return!1;a.kill();const i=a.element;return i.dataset.bdpInit=!1,delete i.dataset.bdpInit,L.remove(i,"instance"),F=!1,!0},l.defaults={minAge:0,maxAge:100,minYear:null,maxYear:"now",lowerLimit:null,upperLimit:null,monthFormat:"short",placeholder:!0,className:null,defaultDate:null,autoInit:!0,leadingZero:!0,locale:"en",selectFuture:!1,arrange:"ymd",yearEl:null,monthEl:null,dayEl:null,roundDownDay:!0},l.init=()=>{if(F)return!1;F=!0,l.createLocale(l.currentLocale);let a=document.querySelectorAll("["+E+"]");return a.length!==0&&(a.forEach(i=>{new l(i)}),f)},l}),globalThis.getDomData)for(const u of Object.keys(globalThis.getDomData))globalThis[u]=globalThis.getDomData[u];
